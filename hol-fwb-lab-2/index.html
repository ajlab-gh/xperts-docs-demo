
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Using XPERTS 2023 Lab Guide to Demo User Contributions and Edits">
      
      
        <meta name="author" content="Alex Jammes">
      
      
        <link rel="canonical" href="https://ajlab-gh.github.io/xperts-docs-demo/hol-fwb-lab-2/">
      
      
        <link rel="prev" href="../hol-nsg-fgt-lab-1/">
      
      
        <link rel="next" href="../architecture/">
      
      
      <link rel="icon" href="../img/fortinet.svg">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.33">
    
    
      
        <title>Lab 2 - FortiWeb - XPERTS Academy - Cloud (Lab Guide Demo)</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.3cba04c6.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="red" data-md-color-accent="red">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#protecting-web-application-using-fortiweb" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="XPERTS Academy - Cloud (Lab Guide Demo)" class="md-header__button md-logo" aria-label="XPERTS Academy - Cloud (Lab Guide Demo)" data-md-component="logo">
      
  <img src="../img/fortinet.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            XPERTS Academy - Cloud (Lab Guide Demo)
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Lab 2 - FortiWeb
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="red" data-md-color-accent="red"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="white" data-md-color-accent="white"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://ajlab-gh.github.io/xperts-docs-demo/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    AJLab-GH/docs-template
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="XPERTS Academy - Cloud (Lab Guide Demo)" class="md-nav__button md-logo" aria-label="XPERTS Academy - Cloud (Lab Guide Demo)" data-md-component="logo">
      
  <img src="../img/fortinet.svg" alt="logo">

    </a>
    XPERTS Academy - Cloud (Lab Guide Demo)
  </label>
  
    <div class="md-nav__source">
      <a href="https://ajlab-gh.github.io/xperts-docs-demo/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    AJLab-GH/docs-template
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Getting Started
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../start-azure-account/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Accessing Your Azure Account
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../start-deploy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Deploying Your Lab Environment in Azure
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Hands on Labs
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Hands on Labs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hol-nsg-fgt-lab-1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab 1 - Azure NSG & FortiGate
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Lab 2 - FortiWeb
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Lab 2 - FortiWeb
  </span>
  

      </a>
      
        

  

<nav class="md-nav md-nav--secondary" aria-label="On this page">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      On this page
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#connecting-to-dvwa" class="md-nav__link">
    <span class="md-ellipsis">
      Connecting to DVWA
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sequence-of-scans" class="md-nav__link">
    <span class="md-ellipsis">
      Sequence of Scans
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fortiweb-policy" class="md-nav__link">
    <span class="md-ellipsis">
      FortiWeb Policy
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-monitoring-with-fortiview" class="md-nav__link">
    <span class="md-ellipsis">
      Security Monitoring with FortiView
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#signatures" class="md-nav__link">
    <span class="md-ellipsis">
      Signatures
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Signatures">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#signature-update-management" class="md-nav__link">
    <span class="md-ellipsis">
      Signature Update Management
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#performing-command-injection" class="md-nav__link">
    <span class="md-ellipsis">
      Performing Command Injection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attack-logs" class="md-nav__link">
    <span class="md-ellipsis">
      Attack Logs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#performing-sql-injection" class="md-nav__link">
    <span class="md-ellipsis">
      Performing SQL Injection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attack-logs_1" class="md-nav__link">
    <span class="md-ellipsis">
      Attack Logs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#machine-learning" class="md-nav__link">
    <span class="md-ellipsis">
      Machine Learning
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Machine Learning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuring-machine-learning" class="md-nav__link">
    <span class="md-ellipsis">
      Configuring Machine Learning
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-machine-learning" class="md-nav__link">
    <span class="md-ellipsis">
      Testing Machine Learning
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attack-logs_2" class="md-nav__link">
    <span class="md-ellipsis">
      Attack Logs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#client-management" class="md-nav__link">
    <span class="md-ellipsis">
      Client Management
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Client Management">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration_1" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#monitoring-clients-activities" class="md-nav__link">
    <span class="md-ellipsis">
      Monitoring Clients’ activities
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#x-forwarded-for" class="md-nav__link">
    <span class="md-ellipsis">
      X-Forwarded-For
    </span>
  </a>
  
    <nav class="md-nav" aria-label="X-Forwarded-For">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration_2" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#checking-http-header-informations" class="md-nav__link">
    <span class="md-ellipsis">
      Checking HTTP header information’s
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cookie-security" class="md-nav__link">
    <span class="md-ellipsis">
      Cookie Security
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cookie Security">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration_3" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#preventing-cookie-poisoning-by-tracking-the-cookie-value" class="md-nav__link">
    <span class="md-ellipsis">
      Preventing cookie poisoning by tracking the cookie value
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attack-logs_3" class="md-nav__link">
    <span class="md-ellipsis">
      Attack Logs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#preventing-cookie-poisoning-with-cookie-encryption" class="md-nav__link">
    <span class="md-ellipsis">
      Preventing cookie poisoning with cookie encryption
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#preventing-client-side-scripts-from-accessing-the-cookie" class="md-nav__link">
    <span class="md-ellipsis">
      Preventing client-side scripts from accessing the cookie
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#csrf-protection" class="md-nav__link">
    <span class="md-ellipsis">
      CSRF Protection
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CSRF Protection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration_4" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#preventing-cross-site-request-forgery" class="md-nav__link">
    <span class="md-ellipsis">
      Preventing cross-site request forgery
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attack-logs_4" class="md-nav__link">
    <span class="md-ellipsis">
      Attack Logs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hidden-fields-protection" class="md-nav__link">
    <span class="md-ellipsis">
      Hidden Fields Protection
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hidden Fields Protection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration_5" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-hidden-field-protection" class="md-nav__link">
    <span class="md-ellipsis">
      Testing hidden field protection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attack-logs_5" class="md-nav__link">
    <span class="md-ellipsis">
      Attack Logs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#file-security" class="md-nav__link">
    <span class="md-ellipsis">
      File Security
    </span>
  </a>
  
    <nav class="md-nav" aria-label="File Security">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration_6" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-file-security" class="md-nav__link">
    <span class="md-ellipsis">
      Testing file security
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attack-logs_6" class="md-nav__link">
    <span class="md-ellipsis">
      Attack Logs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#web-shell-detection" class="md-nav__link">
    <span class="md-ellipsis">
      Web Shell Detection
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Web Shell Detection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration_7" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-web-shell-detection" class="md-nav__link">
    <span class="md-ellipsis">
      Testing Web Shell detection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attack-logs_7" class="md-nav__link">
    <span class="md-ellipsis">
      Attack Logs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lets-encrypt-certificates" class="md-nav__link">
    <span class="md-ellipsis">
      Let’s Encrypt Certificates
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Let’s Encrypt Certificates">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration_8" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generating-a-new-lets-encrypt-certificate" class="md-nav__link">
    <span class="md-ellipsis">
      Generating a new Let’s Encrypt certificate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#event-logs" class="md-nav__link">
    <span class="md-ellipsis">
      Event Logs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#allow-method" class="md-nav__link">
    <span class="md-ellipsis">
      Allow Method
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Allow Method">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration_9" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-allow-method" class="md-nav__link">
    <span class="md-ellipsis">
      Testing Allow Method
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attack-logs_8" class="md-nav__link">
    <span class="md-ellipsis">
      Attack logs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bot-mitigation-policy" class="md-nav__link">
    <span class="md-ellipsis">
      Bot Mitigation Policy
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Bot Mitigation Policy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration_10" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-bot-deception" class="md-nav__link">
    <span class="md-ellipsis">
      Testing Bot Deception
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attack-logs_9" class="md-nav__link">
    <span class="md-ellipsis">
      Attack Logs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dos-protection-policy" class="md-nav__link">
    <span class="md-ellipsis">
      DoS Protection Policy
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DoS Protection Policy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration_11" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-dos-http-flood" class="md-nav__link">
    <span class="md-ellipsis">
      Testing DoS HTTP Flood
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attack-logs_10" class="md-nav__link">
    <span class="md-ellipsis">
      Attack Logs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#url-rewriting" class="md-nav__link">
    <span class="md-ellipsis">
      URL Rewriting
    </span>
  </a>
  
    <nav class="md-nav" aria-label="URL Rewriting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration_12" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-url-rewrite-301-redirect" class="md-nav__link">
    <span class="md-ellipsis">
      Testing URL Rewrite (301 Redirect)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-url-rewrite-rewrite-http-header" class="md-nav__link">
    <span class="md-ellipsis">
      Testing URL Rewrite (Rewrite HTTP Header)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#traffic-logs" class="md-nav__link">
    <span class="md-ellipsis">
      Traffic logs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#user-tracking" class="md-nav__link">
    <span class="md-ellipsis">
      User Tracking
    </span>
  </a>
  
    <nav class="md-nav" aria-label="User Tracking">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration_13" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-user-tracking" class="md-nav__link">
    <span class="md-ellipsis">
      Testing User Tracking
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attack-logs_11" class="md-nav__link">
    <span class="md-ellipsis">
      Attack Logs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#custom-policy" class="md-nav__link">
    <span class="md-ellipsis">
      Custom Policy
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Custom Policy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration_14" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-vulnerability-scanning" class="md-nav__link">
    <span class="md-ellipsis">
      Testing Vulnerability Scanning
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-brute-force-attack" class="md-nav__link">
    <span class="md-ellipsis">
      Testing brute force attack
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attack-logs_12" class="md-nav__link">
    <span class="md-ellipsis">
      Attack Logs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#http-protocol-constraints" class="md-nav__link">
    <span class="md-ellipsis">
      HTTP Protocol Constraints
    </span>
  </a>
  
    <nav class="md-nav" aria-label="HTTP Protocol Constraints">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration_15" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#performing-duplicate-name-attack" class="md-nav__link">
    <span class="md-ellipsis">
      Performing duplicate name attack
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attack-logs_13" class="md-nav__link">
    <span class="md-ellipsis">
      Attack Logs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#http-header-security" class="md-nav__link">
    <span class="md-ellipsis">
      HTTP Header Security
    </span>
  </a>
  
    <nav class="md-nav" aria-label="HTTP Header Security">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration_16" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-http-header-security" class="md-nav__link">
    <span class="md-ellipsis">
      Testing HTTP Header Security
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#parameter-validation" class="md-nav__link">
    <span class="md-ellipsis">
      Parameter Validation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Parameter Validation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration_17" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-parameter-validation" class="md-nav__link">
    <span class="md-ellipsis">
      Testing parameter validation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attack-logs_14" class="md-nav__link">
    <span class="md-ellipsis">
      Attack Logs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#man-in-the-browser-mitb-protection" class="md-nav__link">
    <span class="md-ellipsis">
      Man in the Browser (MiTB) Protection
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Man in the Browser (MiTB) Protection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration_18" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-mitb" class="md-nav__link">
    <span class="md-ellipsis">
      Testing MitB
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#url-access" class="md-nav__link">
    <span class="md-ellipsis">
      URL Access
    </span>
  </a>
  
    <nav class="md-nav" aria-label="URL Access">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration_19" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-url-access" class="md-nav__link">
    <span class="md-ellipsis">
      Testing URL Access
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attack-logs_15" class="md-nav__link">
    <span class="md-ellipsis">
      Attack Logs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#http-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      HTTP Authentication
    </span>
  </a>
  
    <nav class="md-nav" aria-label="HTTP Authentication">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration_20" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      Testing authentication
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ip-list" class="md-nav__link">
    <span class="md-ellipsis">
      IP List
    </span>
  </a>
  
    <nav class="md-nav" aria-label="IP List">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration_21" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-ip-list" class="md-nav__link">
    <span class="md-ellipsis">
      Testing IP List
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attack-logs_16" class="md-nav__link">
    <span class="md-ellipsis">
      Attack Logs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fortigate-quarantined-ips" class="md-nav__link">
    <span class="md-ellipsis">
      FortiGate Quarantined IPs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FortiGate Quarantined IPs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration_22" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-fortigate-integration" class="md-nav__link">
    <span class="md-ellipsis">
      Testing FortiGate integration
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geo-ip" class="md-nav__link">
    <span class="md-ellipsis">
      GEO IP
    </span>
  </a>
  
    <nav class="md-nav" aria-label="GEO IP">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration_23" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-geo-ip" class="md-nav__link">
    <span class="md-ellipsis">
      Testing Geo IP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attack-logs_17" class="md-nav__link">
    <span class="md-ellipsis">
      Attack Logs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vulnerability-scanner" class="md-nav__link">
    <span class="md-ellipsis">
      Vulnerability Scanner
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Vulnerability Scanner">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration_24" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#performing-a-scan" class="md-nav__link">
    <span class="md-ellipsis">
      Performing a scan
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Resources
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Resources
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Reference Architecture
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../bootstrap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FortiWeb Bootstrap
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../role-play/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cloud Role Play
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../download-pdf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Download HoL (pdf)
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--secondary" aria-label="On this page">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      On this page
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#connecting-to-dvwa" class="md-nav__link">
    <span class="md-ellipsis">
      Connecting to DVWA
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sequence-of-scans" class="md-nav__link">
    <span class="md-ellipsis">
      Sequence of Scans
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fortiweb-policy" class="md-nav__link">
    <span class="md-ellipsis">
      FortiWeb Policy
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-monitoring-with-fortiview" class="md-nav__link">
    <span class="md-ellipsis">
      Security Monitoring with FortiView
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#signatures" class="md-nav__link">
    <span class="md-ellipsis">
      Signatures
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Signatures">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#signature-update-management" class="md-nav__link">
    <span class="md-ellipsis">
      Signature Update Management
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#performing-command-injection" class="md-nav__link">
    <span class="md-ellipsis">
      Performing Command Injection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attack-logs" class="md-nav__link">
    <span class="md-ellipsis">
      Attack Logs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#performing-sql-injection" class="md-nav__link">
    <span class="md-ellipsis">
      Performing SQL Injection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attack-logs_1" class="md-nav__link">
    <span class="md-ellipsis">
      Attack Logs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#machine-learning" class="md-nav__link">
    <span class="md-ellipsis">
      Machine Learning
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Machine Learning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuring-machine-learning" class="md-nav__link">
    <span class="md-ellipsis">
      Configuring Machine Learning
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-machine-learning" class="md-nav__link">
    <span class="md-ellipsis">
      Testing Machine Learning
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attack-logs_2" class="md-nav__link">
    <span class="md-ellipsis">
      Attack Logs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#client-management" class="md-nav__link">
    <span class="md-ellipsis">
      Client Management
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Client Management">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration_1" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#monitoring-clients-activities" class="md-nav__link">
    <span class="md-ellipsis">
      Monitoring Clients’ activities
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#x-forwarded-for" class="md-nav__link">
    <span class="md-ellipsis">
      X-Forwarded-For
    </span>
  </a>
  
    <nav class="md-nav" aria-label="X-Forwarded-For">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration_2" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#checking-http-header-informations" class="md-nav__link">
    <span class="md-ellipsis">
      Checking HTTP header information’s
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cookie-security" class="md-nav__link">
    <span class="md-ellipsis">
      Cookie Security
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cookie Security">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration_3" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#preventing-cookie-poisoning-by-tracking-the-cookie-value" class="md-nav__link">
    <span class="md-ellipsis">
      Preventing cookie poisoning by tracking the cookie value
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attack-logs_3" class="md-nav__link">
    <span class="md-ellipsis">
      Attack Logs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#preventing-cookie-poisoning-with-cookie-encryption" class="md-nav__link">
    <span class="md-ellipsis">
      Preventing cookie poisoning with cookie encryption
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#preventing-client-side-scripts-from-accessing-the-cookie" class="md-nav__link">
    <span class="md-ellipsis">
      Preventing client-side scripts from accessing the cookie
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#csrf-protection" class="md-nav__link">
    <span class="md-ellipsis">
      CSRF Protection
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CSRF Protection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration_4" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#preventing-cross-site-request-forgery" class="md-nav__link">
    <span class="md-ellipsis">
      Preventing cross-site request forgery
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attack-logs_4" class="md-nav__link">
    <span class="md-ellipsis">
      Attack Logs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hidden-fields-protection" class="md-nav__link">
    <span class="md-ellipsis">
      Hidden Fields Protection
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hidden Fields Protection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration_5" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-hidden-field-protection" class="md-nav__link">
    <span class="md-ellipsis">
      Testing hidden field protection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attack-logs_5" class="md-nav__link">
    <span class="md-ellipsis">
      Attack Logs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#file-security" class="md-nav__link">
    <span class="md-ellipsis">
      File Security
    </span>
  </a>
  
    <nav class="md-nav" aria-label="File Security">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration_6" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-file-security" class="md-nav__link">
    <span class="md-ellipsis">
      Testing file security
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attack-logs_6" class="md-nav__link">
    <span class="md-ellipsis">
      Attack Logs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#web-shell-detection" class="md-nav__link">
    <span class="md-ellipsis">
      Web Shell Detection
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Web Shell Detection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration_7" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-web-shell-detection" class="md-nav__link">
    <span class="md-ellipsis">
      Testing Web Shell detection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attack-logs_7" class="md-nav__link">
    <span class="md-ellipsis">
      Attack Logs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lets-encrypt-certificates" class="md-nav__link">
    <span class="md-ellipsis">
      Let’s Encrypt Certificates
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Let’s Encrypt Certificates">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration_8" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generating-a-new-lets-encrypt-certificate" class="md-nav__link">
    <span class="md-ellipsis">
      Generating a new Let’s Encrypt certificate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#event-logs" class="md-nav__link">
    <span class="md-ellipsis">
      Event Logs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#allow-method" class="md-nav__link">
    <span class="md-ellipsis">
      Allow Method
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Allow Method">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration_9" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-allow-method" class="md-nav__link">
    <span class="md-ellipsis">
      Testing Allow Method
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attack-logs_8" class="md-nav__link">
    <span class="md-ellipsis">
      Attack logs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bot-mitigation-policy" class="md-nav__link">
    <span class="md-ellipsis">
      Bot Mitigation Policy
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Bot Mitigation Policy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration_10" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-bot-deception" class="md-nav__link">
    <span class="md-ellipsis">
      Testing Bot Deception
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attack-logs_9" class="md-nav__link">
    <span class="md-ellipsis">
      Attack Logs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dos-protection-policy" class="md-nav__link">
    <span class="md-ellipsis">
      DoS Protection Policy
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DoS Protection Policy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration_11" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-dos-http-flood" class="md-nav__link">
    <span class="md-ellipsis">
      Testing DoS HTTP Flood
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attack-logs_10" class="md-nav__link">
    <span class="md-ellipsis">
      Attack Logs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#url-rewriting" class="md-nav__link">
    <span class="md-ellipsis">
      URL Rewriting
    </span>
  </a>
  
    <nav class="md-nav" aria-label="URL Rewriting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration_12" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-url-rewrite-301-redirect" class="md-nav__link">
    <span class="md-ellipsis">
      Testing URL Rewrite (301 Redirect)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-url-rewrite-rewrite-http-header" class="md-nav__link">
    <span class="md-ellipsis">
      Testing URL Rewrite (Rewrite HTTP Header)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#traffic-logs" class="md-nav__link">
    <span class="md-ellipsis">
      Traffic logs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#user-tracking" class="md-nav__link">
    <span class="md-ellipsis">
      User Tracking
    </span>
  </a>
  
    <nav class="md-nav" aria-label="User Tracking">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration_13" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-user-tracking" class="md-nav__link">
    <span class="md-ellipsis">
      Testing User Tracking
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attack-logs_11" class="md-nav__link">
    <span class="md-ellipsis">
      Attack Logs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#custom-policy" class="md-nav__link">
    <span class="md-ellipsis">
      Custom Policy
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Custom Policy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration_14" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-vulnerability-scanning" class="md-nav__link">
    <span class="md-ellipsis">
      Testing Vulnerability Scanning
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-brute-force-attack" class="md-nav__link">
    <span class="md-ellipsis">
      Testing brute force attack
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attack-logs_12" class="md-nav__link">
    <span class="md-ellipsis">
      Attack Logs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#http-protocol-constraints" class="md-nav__link">
    <span class="md-ellipsis">
      HTTP Protocol Constraints
    </span>
  </a>
  
    <nav class="md-nav" aria-label="HTTP Protocol Constraints">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration_15" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#performing-duplicate-name-attack" class="md-nav__link">
    <span class="md-ellipsis">
      Performing duplicate name attack
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attack-logs_13" class="md-nav__link">
    <span class="md-ellipsis">
      Attack Logs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#http-header-security" class="md-nav__link">
    <span class="md-ellipsis">
      HTTP Header Security
    </span>
  </a>
  
    <nav class="md-nav" aria-label="HTTP Header Security">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration_16" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-http-header-security" class="md-nav__link">
    <span class="md-ellipsis">
      Testing HTTP Header Security
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#parameter-validation" class="md-nav__link">
    <span class="md-ellipsis">
      Parameter Validation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Parameter Validation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration_17" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-parameter-validation" class="md-nav__link">
    <span class="md-ellipsis">
      Testing parameter validation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attack-logs_14" class="md-nav__link">
    <span class="md-ellipsis">
      Attack Logs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#man-in-the-browser-mitb-protection" class="md-nav__link">
    <span class="md-ellipsis">
      Man in the Browser (MiTB) Protection
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Man in the Browser (MiTB) Protection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration_18" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-mitb" class="md-nav__link">
    <span class="md-ellipsis">
      Testing MitB
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#url-access" class="md-nav__link">
    <span class="md-ellipsis">
      URL Access
    </span>
  </a>
  
    <nav class="md-nav" aria-label="URL Access">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration_19" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-url-access" class="md-nav__link">
    <span class="md-ellipsis">
      Testing URL Access
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attack-logs_15" class="md-nav__link">
    <span class="md-ellipsis">
      Attack Logs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#http-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      HTTP Authentication
    </span>
  </a>
  
    <nav class="md-nav" aria-label="HTTP Authentication">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration_20" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      Testing authentication
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ip-list" class="md-nav__link">
    <span class="md-ellipsis">
      IP List
    </span>
  </a>
  
    <nav class="md-nav" aria-label="IP List">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration_21" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-ip-list" class="md-nav__link">
    <span class="md-ellipsis">
      Testing IP List
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attack-logs_16" class="md-nav__link">
    <span class="md-ellipsis">
      Attack Logs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fortigate-quarantined-ips" class="md-nav__link">
    <span class="md-ellipsis">
      FortiGate Quarantined IPs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FortiGate Quarantined IPs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration_22" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-fortigate-integration" class="md-nav__link">
    <span class="md-ellipsis">
      Testing FortiGate integration
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geo-ip" class="md-nav__link">
    <span class="md-ellipsis">
      GEO IP
    </span>
  </a>
  
    <nav class="md-nav" aria-label="GEO IP">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration_23" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-geo-ip" class="md-nav__link">
    <span class="md-ellipsis">
      Testing Geo IP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attack-logs_17" class="md-nav__link">
    <span class="md-ellipsis">
      Attack Logs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vulnerability-scanner" class="md-nav__link">
    <span class="md-ellipsis">
      Vulnerability Scanner
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Vulnerability Scanner">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration_24" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#performing-a-scan" class="md-nav__link">
    <span class="md-ellipsis">
      Performing a scan
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="protecting-web-application-using-fortiweb">Protecting Web Application Using FortiWeb</h1>
<p>To begin, we will connect to the DVWA Web Application through FortiWeb.</p>
<details class="note">
<summary>Connecting to DVWA</summary>
<h2 id="connecting-to-dvwa">Connecting to DVWA</h2>
<p>Connect to <a href="https://@PREFIX.@REGION.cloudapp.azure.com" target="_blank">https://@PREFIX.@REGION.cloudapp.azure.com</a>
and authenticate with one of these accounts:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Username</th>
<th style="text-align: left;">Password</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">admin</td>
<td style="text-align: left;">password</td>
</tr>
<tr>
<td style="text-align: left;">gordonb</td>
<td style="text-align: left;">abc123</td>
</tr>
<tr>
<td style="text-align: left;">1337</td>
<td style="text-align: left;">charley</td>
</tr>
<tr>
<td style="text-align: left;">pablo</td>
<td style="text-align: left;">letmein</td>
</tr>
<tr>
<td style="text-align: left;">smithy</td>
<td style="text-align: left;">password</td>
</tr>
</tbody>
</table>
<details class="tip">
<summary>Troubleshooting - If you encounter any authentication issues</summary>
<ul>
<li>
<p>Browse to <a href="https://@PREFIX.@REGION.cloudapp.azure.com/setup.php" target="_blank">https://@PREFIX.@REGION.cloudapp.azure.com/setup.php</a></p>
</li>
<li>
<p>Click on <strong>Create / Reset Database</strong></p>
</li>
</ul>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.006.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.006.png" /></a></p>
</details>
</details>
<p>This Hands-on Lab allows us to demonstrate 25+ FortiWeb protections. Let's take a closer look at FortiWeb's sequence of scans.</p>
<details class="note">
<summary>Sequence of Scans</summary>
<h2 id="sequence-of-scans">Sequence of Scans</h2>
<p>FortiWeb applies protection rules and performs protection profile scans in the order of execution according to the following list. The second tab <mark>highlights</mark> the security features that will be demonstrated in this Hands-On Lab.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">Protections</label><label for="__tabbed_1_2">Highlights</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<ol>
<li>TCP Connection Number Limit (TCP Flood Prevention)</li>
<li>Add X-Forwarded-For</li>
<li>Client Management</li>
<li>IP List</li>
<li>IP Reputation</li>
<li>Quarantined source IP addresses</li>
<li>Known Bots</li>
<li>Geo IP</li>
<li>WebSocket protocol</li>
<li>Add HSTS Header</li>
<li>Protected Server Check</li>
<li>Allow Method</li>
<li>Mobile Application Identification</li>
<li>HTTP Request Limit/sec (HTTP Flood Prevention)</li>
<li>TCP Connection Number Limit (Malicious IP)</li>
<li>HTTP Request Limit/sec (Shared IP) (HTTP Access Limit)</li>
<li>HTTP Authentication</li>
<li>Global Object Allow List</li>
<li>ADFS Proxy</li>
<li>URL Access</li>
<li>Mobile API Protection</li>
<li>Padding Oracle Protection</li>
<li>HTTP Protocol Constraints</li>
<li>File Parse</li>
<li>File Security</li>
<li>Web Shell Protection</li>
<li>Parameter Validation</li>
<li>Bot Deception</li>
<li>ML based Bot Detection</li>
<li>Cross-site request forgery (CSRF) attacks</li>
<li>Protection for Man-in-the-Browser (MiTB) attacks</li>
<li>Biometrics Based Detection</li>
<li>XML Protection</li>
<li>JSON Protection</li>
<li>Signatures</li>
<li>SQL/XSS Syntax Based Detection</li>
<li>Site Publish</li>
<li>Hidden Fields Protection</li>
<li>Custom Policy</li>
<li>Threshold Based Detection</li>
<li>User Tracking</li>
<li>API Gateway</li>
<li>OpenAPI Validation</li>
<li>CORS Protection</li>
<li>URL Rewriting (rewriting &amp; redirection)</li>
<li>ML based API Protection</li>
<li>File Compress</li>
<li>Cookie Security Policy</li>
<li>ML based Anomaly Detection</li>
</ol>
</div>
<div class="tabbed-block">
<ol>
<li>TCP Connection Number Limit (TCP Flood Prevention)</li>
<li><mark>Add X-Forwarded-For</mark></li>
<li><mark>Client Management</mark></li>
<li><mark>IP List</mark></li>
<li>IP Reputation</li>
<li><mark>Quarantined source IP addresses</mark></li>
<li>Known Bots</li>
<li><mark>Geo IP</mark></li>
<li>WebSocket protocol</li>
<li>Add HSTS Header</li>
<li>Protected Server Check</li>
<li><mark>Allow Method</mark></li>
<li>Mobile Application Identification</li>
<li><mark>HTTP Request Limit/sec (HTTP Flood Prevention)</mark></li>
<li>TCP Connection Number Limit (Malicious IP)</li>
<li>HTTP Request Limit/sec (Shared IP) (HTTP Access Limit)</li>
<li><mark>HTTP Authentication</mark></li>
<li>Global Object Allow List</li>
<li>ADFS Proxy</li>
<li><mark>URL Access</mark></li>
<li>Mobile API Protection</li>
<li>Padding Oracle Protection</li>
<li><mark>HTTP Protocol Constraints</mark></li>
<li><mark>File Parse</mark></li>
<li><mark>File Security</mark></li>
<li><mark>Web Shell Protection</mark></li>
<li><mark>Parameter Validation</mark></li>
<li><mark>Bot Deception</mark></li>
<li>ML based Bot Detection</li>
<li><mark>Cross-site request forgery (CSRF) attacks</mark></li>
<li><mark>Protection for Man-in-the-Browser (MiTB) attacks</mark></li>
<li>Biometrics Based Detection</li>
<li>XML Protection</li>
<li>JSON Protection</li>
<li><mark>Signatures</mark></li>
<li>SQL/XSS Syntax Based Detection</li>
<li>Site Publish</li>
<li><mark>Hidden Fields Protection</mark></li>
<li><mark>Custom Policy</mark></li>
<li>Threshold Based Detection</li>
<li><mark>User Tracking</mark></li>
<li>API Gateway</li>
<li>OpenAPI Validation</li>
<li>CORS Protection</li>
<li><mark>URL Rewriting (rewriting &amp; redirection)</mark></li>
<li>ML based API Protection</li>
<li>File Compress</li>
<li><mark>Cookie Security Policy</mark></li>
<li><mark>ML based Anomaly Detection</mark></li>
</ol>
</div>
</div>
</div>
</details>
<p>The WAF policy <strong>DVWA_PROTECTION_PROFILE</strong> is already populated with protections that we will demonstrate in the next sections.</p>
<details class="note">
<summary>FortiWeb Policy</summary>
<h2 id="fortiweb-policy">FortiWeb Policy</h2>
<p>Log in to the FortiWeb GUI <a href="https://@PREFIX.@REGION.cloudapp.azure.com:40030" target="_blank">https://@PREFIX.@REGION.cloudapp.azure.com:40030</a>.</p>
<p>Browse to <code>Policy &gt; Web Protection Profile</code> and open <strong>DVWA_PROTECTION_PROFILE</strong>.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.011.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.011.png" /></a></p>
</details>
<p>Throughout the Hands-On Lab, we will utilize the <strong>Attack Logs</strong> as well as <strong>FortiView</strong> to gain a comprehensive view of the activity.</p>
<details class="note">
<summary>Security Monitoring with FortiView</summary>
<h2 id="security-monitoring-with-fortiview">Security Monitoring with FortiView</h2>
<p>These are the most common views to monitor your device, traffic, and security posture.</p>
<p><code>Dashboard &gt; FortiView topology</code></p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.012.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.012.png" /></a></p>
<p><code>Dashboard &gt; FortiView Countries</code></p>
<p>You can drill down each <strong>Country</strong>.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.013.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.013.png" /></a></p>
<p><code>Dashboard &gt; FortiView Threats</code></p>
<p>You can drill down each <strong>Threat</strong>.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.014.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.014.png" /></a></p>
<p><code>Dashboard &gt; FortiView Countries</code></p>
<p>You can drill down each <strong>Source IP</strong>.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.015.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.015.png" /></a></p>
<p>And you can ban specific IPs.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.016.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.016.png" /></a></p>
<p><code>Dashboard &gt; Blocked IPs</code></p>
<p>Monitoring &amp; Releasing Ban IPs.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.017.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.017.png" /></a></p>
<p><code>Dashboard &gt; Status</code> (Throughput &amp; Attack Event History)</p>
<p>You can drill down each <strong>Threat Level</strong>.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.018.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.018.png" /></a></p>
<p>You can also add your own monitor view. We will use them later in this document.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.019.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.019.png" /></a></p>
</details>
<p>This page provides you with instructions for demonstrating various FortiWeb protections using the DVWA Application.</p>
<p>Given that we have limited time for the workshops, we suggest focusing first on the protections that seem most important to us. If you have extra time, you can choose to test other features.</p>
<p>Each section of this lab is independent of the others, so have fun!</p>
<details class="note">
<summary>Signatures (Known Attacks)</summary>
<h2 id="signatures">Signatures</h2>
<p>FortiWeb uses signatures to detect a wide range of attacks and data leaks, covering vulnerabilities listed in the OWASP Top 10 and beyond. These include cross-site scripting, SQL injection, remote and local file inclusion, OS commands, trojans/viruses, exploits, and leaks of sensitive server information and personal data.</p>
<h3 id="configuration">Configuration</h3>
<p><code>Web Protection &gt; Known Attacks &gt; Signatures</code></p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.020.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.020.png" /></a></p>
<h3 id="signature-update-management">Signature Update Management</h3>
<p>Make sure to approve the latest signatures.</p>
<p>Browse to <code>System &gt; Config &gt; FortiGuard &gt; Signature Update Management</code> and approve all new signatures.</p>
<p>Use the Shift key to select everything and approve all at once.</p>
<p><a class="glightbox" href="../img/signature-update-management.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/signature-update-management.png" /></a></p>
<h3 id="performing-command-injection">Performing Command Injection</h3>
<p>Browse to <a href="https://@PREFIX.@REGION.cloudapp.azure.com/vulnerabilities/exec/" target="_blank">https://@PREFIX.@REGION.cloudapp.azure.com/vulnerabilities/exec/</a> and try one of these Command Injection attacks.</p>
<p><div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>;ls -la
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>;more /etc/passwd
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>;ps -aux
</span></code></pre></div></p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.021.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.021.png" /></a></p>
<p>Command Injection will be <strong>blocked</strong>.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.022.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.022.png" /></a></p>
<h3 id="attack-logs">Attack Logs</h3>
<p><code>Log&amp;Report &gt; Log Access &gt; Attack</code></p>
<p>Double click on the last entry.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.023.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.023.png" /></a></p>
<h3 id="performing-sql-injection">Performing SQL Injection</h3>
<p>Browse to <a href="https://@PREFIX.@REGION.cloudapp.azure.com/vulnerabilities/sqli/" target="_blank">https://@PREFIX.@REGION.cloudapp.azure.com/vulnerabilities/sqli/</a> and try this SQL Injection attack.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>&#39; OR 1=1#
</span></code></pre></div>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.024.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.024.png" /></a></p>
<p>SQL Injection will be <strong>blocked</strong>.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.025.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.025.png" /></a></p>
<h3 id="attack-logs_1">Attack Logs</h3>
<p><code>Log&amp;Report &gt; Log Access &gt; Attack</code></p>
<p><strong>Refresh Logs</strong> and double click on the new entry.</p>
<p><a class="glightbox" href="../img/fwb-refresh-logs.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/fwb-refresh-logs.png" /></a></p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.026.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.026.png" /></a></p>
</details>
<details class="note">
<summary>Machine Learning</summary>
<h2 id="machine-learning">Machine Learning</h2>
<p>The anomaly detection model of machine learning feature observes the URLs, parameters, and HTTP Method of HTTP and/or HTTPS sessions passing to your web servers. It builds mathematical models to detect abnormal traffic.</p>
<h3 id="configuring-machine-learning">Configuring Machine Learning</h3>
<p>browse to <code>Policy &gt; Server Policy</code>, open <code>DVWA_POLICY</code>, go at the bottom page, and create your Machine Learning policy.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.029.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.029.png" /></a></p>
<p>Enter the domain name of your application. We will be using a <strong>wildcard</strong> domain. Click OK.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>*.cloudapp.azure.com
</span></code></pre></div>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.030.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.030.png" /></a></p>
<p>Get the <a href="../download/machine-learning-model.dat">Machine Learning Model File</a> and import it.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.032.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.032.png" /></a></p>
<p>Browse to <code>Web Protection &gt; ML Based Anomaly Detection</code>, open the policy, and click on the <strong>domain</strong>.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.033.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.033.png" /></a></p>
<p>Click on the <strong>Parameter View</strong> tab and select the <strong>ip</strong> parameter.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.034.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.034.png" /></a></p>
<p>The <strong>Parameter View</strong> provides statistics associated with various parameters, including HMM learning stages, boxplots, and the distribution of anomalies. It also allows you to rebuild parameters or adjust the strictness level for anomaly detection.</p>
<p>The <strong>diagram</strong> illustrates the Distribution of Anomalies. The system determines the legitimacy of a request based on its probability score and the length of the parameter value.</p>
<p>Click on <strong>Test Sample</strong>.</p>
<table>
<thead>
<tr>
<th style="text-align: left;">These are few samples you can test</th>
<th style="text-align: left;">Samples</th>
<th style="text-align: left;">Examine the Probability Score and Detection Result</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">A real IP</td>
<td style="text-align: left;"><code>1.1.1.1</code></td>
<td style="text-align: left;"><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.035.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.035.png" /></a></td>
</tr>
<tr>
<td style="text-align: left;">A typo</td>
<td style="text-align: left;"><code>1.1.1..1</code></td>
<td style="text-align: left;"><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.036.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.036.png" /></a></td>
</tr>
<tr>
<td style="text-align: left;">Another typo</td>
<td style="text-align: left;"><code>1.1.1.1&amp;</code></td>
<td style="text-align: left;"><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.037.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.037.png" /></a></td>
</tr>
<tr>
<td style="text-align: left;">An email address</td>
<td style="text-align: left;"><code>abc@real.com</code></td>
<td style="text-align: left;"><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.038.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.038.png" /></a></td>
</tr>
<tr>
<td style="text-align: left;">SQL Injection</td>
<td style="text-align: left;"><code>'OR 1=1#</code></td>
<td style="text-align: left;"><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.039.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.039.png" /></a></td>
</tr>
<tr>
<td style="text-align: left;">Zero Day</td>
<td style="text-align: left;"><code>A 'DIV' B - A 'DIV B</code></td>
<td style="text-align: left;"><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.040.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.040.png" /></a></td>
</tr>
</tbody>
</table>
<details class="question">
<summary>Why FortiWeb employs two layers of machine learning?</summary>
<p>FortiWeb employs a dual-layer machine learning approach to identify malicious attacks. The first layer utilizes the <a href="https://en.wikipedia.org/wiki/Hidden_Markov_model" target="_blank">Hidden Markov Model (HMM)</a> to monitor application access and collect data, which is used to build a mathematical model for each parameter and HTTP method. Once this model is established, FortiWeb assesses each incoming request against it to determine whether it is anomalous.</p>
<p>If the first machine learning layer flags a request as anomalous, FortiWeb engages its second layer to further scrutinize whether it constitutes a genuine attack or is merely a benign anomaly that can be disregarded. To accomplish this, FortiWeb incorporates pre-trained threat models that utilize <a href="https://en.wikipedia.org/wiki/Support_vector_machine" target="_blank">Support Vector Machine (SVM)</a> technology, each representing a specific type of attack, such as SQL Injection or Cross-site Scripting. These models have been trained using data from thousands of attack samples and are consistently updated by the FortiWeb Security Service. When new types of attacks emerge, the FortiGuard team analyzes them and updates the relevant threat models. These updated models are then distributed to all customer installations, similar to how signature updates are carried out.</p>
<p><a class="glightbox" href="../img/fwb-ml-two-layers.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/fwb-ml-two-layers.png" /></a></p>
</details>
<h3 id="testing-machine-learning">Testing Machine Learning</h3>
<p>Browse to <a href="https://@PREFIX.@REGION.cloudapp.azure.com/vulnerabilities/exec/" target="_blank">https://@PREFIX.@REGION.cloudapp.azure.com/vulnerabilities/exec/</a> and perform those 2 SQL Injections.</p>
<p><div class="language-text highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>&#39;OR 1=1#
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>A &#39;DIV&#39; B - A &#39;DIV B
</span></code></pre></div></p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.041.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.041.png" /></a></p>
<h3 id="attack-logs_2">Attack Logs</h3>
<p>The first pattern is detected by <strong>Signatures</strong> <strong>Detection</strong> and the second one by <strong>Machine Learning</strong>.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.042.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.042.png" /></a></p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.043.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.043.png" /></a></p>
<details class="question">
<summary>Why is the first attack blocked by signature-based protection, while the second is blocked through machine learning?"</summary>
<p>FortiWeb applies protection rules and performs profile scans in a specific order of execution as documented in <a href="https://docs.fortinet.com/document/fortiweb/7.4.0/administration-guide/234292/sequence-of-scans" target="_blank">FortiWeb 7.4.0 Administration Guide - Sequence of Scans</a>. If an HTTP request matches a known signature, it will be blocked immediately without ever reaching the machine learning engine. On the other hand, for zero-day attacks where no signature is effective, the machine learning engine takes over to detect and block the attack.</p>
</details>
</details>
<details class="note">
<summary>Client Management</summary>
<h2 id="client-management">Client Management</h2>
<p>Tracking a client by either the recognized cookie or the source IP, FortiWeb's client management feature identifies suspected attacks based on the clients. When a client triggers a threat, FortiWeb accumulates the threat score based on the configured threat weight value. When the client's threat score reaches a certain threshold, a corresponding blocking action is performed. To identify a visiting client, FortiWeb generates a unique client ID according to the cookie value or source IP.</p>
<h3 id="configuration_1">Configuration</h3>
<p><code>Policy &gt; Client Management</code></p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.044.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.044.png" /></a></p>
<h3 id="monitoring-clients-activities">Monitoring Clients’ activities</h3>
<p><code>Dashboard &gt; +</code></p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.045.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.045.png" /></a></p>
<p><code>Dashboard &gt; Client Management</code></p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.046.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.046.png" /></a></p>
</details>
<details class="note">
<summary>X-Forwarded-For</summary>
<h2 id="x-forwarded-for">X-Forwarded-For</h2>
<p>In some topologies, you must configure FortiWeb to add X-headers such as:</p>
<ul>
<li>X-Forwarded-For</li>
<li>X-Real-IP</li>
<li>True-Client-IP</li>
</ul>
<p>The X-Forwarded-For (XFF) HTTP header field is a common method for identifying the originating IP address of a client connecting to a web server through an HTTP proxy or load balancer.</p>
<h3 id="configuration_2">Configuration</h3>
<p>Server Objects &gt; X-Forwarded-For</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.049.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.049.png" /></a></p>
<h3 id="checking-http-header-informations">Checking HTTP header information’s</h3>
<p>Browse to <a href="https://@PREFIX.@REGION.cloudapp.azure.com/phpinfo.php" target="_blank">https://@PREFIX.@REGION.cloudapp.azure.com/phpinfo.php</a> and check if you can see your client public IP.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.050.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.050.png" /></a></p>
</details>
<details class="note">
<summary>Cookie Security</summary>
<h2 id="cookie-security">Cookie Security</h2>
<p>This protection prevents cookie-based attacks. A Cookie Security policy can:</p>
<ul>
<li>detect cookie poisoning</li>
<li>encrypt or sign the cookies issued by the back-end servers</li>
<li>add security attributes to cookies</li>
</ul>
<h3 id="configuration_3">Configuration</h3>
<p>On FortiWeb browse to <code>Web Protection &gt; Cookie Security</code> and open <strong>DVWA_COOKIE_SECURITY</strong>.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.051.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.051.png" /></a></p>
<h3 id="preventing-cookie-poisoning-by-tracking-the-cookie-value">Preventing cookie poisoning by tracking the cookie value</h3>
<p>Browse to  <a href="https://@PREFIX.@REGION.cloudapp.azure.com/security.php" target="_blank">https://@PREFIX.@REGION.cloudapp.azure.com/security.php</a></p>
<p>Right click the page and select <strong>Inspect</strong>, go to <strong>Storage</strong> (Firefox) or <strong>Application</strong> (Chrome, Edge) and select <strong>Cookies</strong>.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.052.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.052.png" /></a></p>
<p>The security level of the DVWA application (Impossible, High, Medium, Low) is stored in a cookie.</p>
<p>First, we'll change the security level using the legitimate method. From the web page, select <strong>Medium</strong> and click <strong>Submit</strong>. You'll notice that your security level has changed.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.053.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.053.png" /></a></p>
<p>Now, let's explore how to change our security level by manipulating the cookie named <strong>security</strong>. From the Inspect view, change its value to <strong>high</strong> and <strong>reload</strong> the page.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.054.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.054.png" /></a> </p>
<h3 id="attack-logs_3">Attack Logs</h3>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.055.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.055.png" /></a></p>
<h3 id="preventing-cookie-poisoning-with-cookie-encryption">Preventing cookie poisoning with cookie encryption</h3>
<p>We just employed the <strong>Signed Security Mode</strong> to prevent tampering by tracking the cookie value. </p>
<p>We are now transitioning to the <strong>Encrypted Security Mode</strong>. This feature encrypts the cookie values sent by the back-end web server to clients, ensuring that clients only see encrypted cookies. FortiWeb automatically decrypts cookies submitted by clients before forwarding them to the back-end server, eliminating the need for any back-end server configuration changes.</p>
<p>On FortiWeb , browse to <code>Web Protection &gt; Cookie Security</code> and open <strong>DVWA_COOKIE_SECURITY</strong>.</p>
<p>Change the <strong>Security Mode</strong> to <strong>Encrypted</strong> and click <strong>OK</strong>.</p>
<p><a class="glightbox" href="../img/fwb-cookie-security-encrypted.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/fwb-cookie-security-encrypted.png" /></a></p>
<p><strong>Delete</strong> those 3 cookies:</p>
<ul>
<li><strong>cookiesession1</strong></li>
<li><strong>PHPSESSID</strong></li>
<li><strong>security</strong></li>
</ul>
<p><a class="glightbox" href="../img/fwb-cookie-security-remove-cookies.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/fwb-cookie-security-remove-cookies.png" /></a></p>
<p><strong>Reload</strong> DVWA page.</p>
<p>The cookies are now <strong>encrypted</strong>. You can try again to change the security cookie value and reload the page. What's happening? Check the <strong>Attack Logs</strong>.</p>
<p><a class="glightbox" href="../img/fwb-cookie-security-encrypted-result.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/fwb-cookie-security-encrypted-result.png" /></a></p>
<h3 id="preventing-client-side-scripts-from-accessing-the-cookie">Preventing client-side scripts from accessing the cookie</h3>
<p>DVWA's cookies (<strong>PHPSESSID</strong> and <strong>security</strong>) are set to <strong>Secure</strong> and <strong>HTTPOnly</strong>. The other cookies are not because they belong to FortiWeb which is not part of the policy.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.056.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.056.png" /></a></p>
<div class="admonition note">
<p>A <strong>Secure</strong> cookie is a cookie that is only transmitted over HTTPS (Secure HTTP) connections. When a cookie is marked as "secure," it tells the browser that the cookie should only be sent with requests to HTTPS URLs, thereby reducing the risk of exposing sensitive data in clear text over an insecure network. This attribute is particularly important for cookies that store sensitive information like authentication tokens or session identifiers.</p>
</div>
<div class="admonition note">
<p>An <strong>HTTP Only</strong> cookie is a type of web cookie that is only accessible by the server and not by client-side scripts. This attribute is set by the server when sending the cookie to the client, and it helps to mitigate the risk of cross-site scripting (XSS) attacks. When a cookie has the HttpOnly flag set, it means that the cookie cannot be accessed through client-side languages like JavaScript, making it more secure against certain types of web vulnerabilities.</p>
</div>
<p>Go to the Browser <strong>Console</strong> and type <code>document.cookie</code>.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.057.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.057.png" /></a></p>
<p>The output displays only those cookies that have the <strong>HTTP Only</strong> attribute set to false. Client-side scripts cannot access cookies that are marked as <strong>HTTP Only</strong>.</p>
<p>On FortiWeb browse to <code>Web Protection &gt; Cookie Security</code>, open <strong>DVWA_COOKIE_SECURITY</strong> and disable <strong>HTTP Only</strong>.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.058.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.058.png" /></a></p>
<p>Clear your browser's cache (or remove cookies from the browser's <strong>Inspect</strong> Element window).</p>
<p>Browse to  <a href="https://@PREFIX.@REGION.cloudapp.azure.com" target="_blank">https://@PREFIX.@REGION.cloudapp.azure.com</a>.</p>
<p>Check that <strong>PHPSESSID</strong> and <strong>security</strong> have <strong>HTTP Only</strong> disabled.</p>
<p><a class="glightbox" href="../img/fwb-cookie-security-httponly-false.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/fwb-cookie-security-httponly-false.png" /></a></p>
<p>Go to the Browser <strong>Console</strong> and type <code>document.cookie</code>.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.059.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.059.png" /></a></p>
<p>You are now able to execute a script that shows cookies. There is no FortiWeb’s log since this is a Browser Cookie Security enforcement.</p>
</details>
<details class="note">
<summary>CSRF Protection</summary>
<h2 id="csrf-protection">CSRF Protection</h2>
<p>Cross-Site Request Forgery (CSRF) is a type of security vulnerability that dupes a web browser into executing an undesired action within an authenticated application.</p>
<p>The attack usually involves deceptive social engineering tactics, such as sending a misleading email or link to the victim. Because the user is already authenticated within the application when the attack occurs, it becomes challenging to differentiate between legitimate and fraudulent requests.</p>
<h3 id="configuration_4">Configuration</h3>
<p><code>Web Protection &gt; Advanced Protection &gt; CSRF Protection</code></p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.069.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.069.png" /></a></p>
<h3 id="preventing-cross-site-request-forgery">Preventing cross-site request forgery</h3>
<p>Browse to <a href="https://@PREFIX.@REGION.cloudapp.azure.com/vulnerabilities/csrf/" target="_blank">https://@PREFIX.@REGION.cloudapp.azure.com/vulnerabilities/csrf/</a> and change the admin password.</p>
<p>You should see a token (<strong>tknfv</strong>) in the URL that has been added by FortiWeb, meaning that the request is protected and allowed.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.070.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.070.png" /></a></p>
<p>You can <strong>log out</strong> and then <strong>log in</strong> again with your <strong>new password</strong>.</p>
<p>Make sure you are authenticated to DVWA and browse to this <a href="/csrf-demo-page.html" target="_blank">demo page</a> to generate the attack.</p>
<p>The aforementioned page employs Cross-Site Request Forgery to exploit your authenticated session in order to initiate a password change.</p>
<p><a class="glightbox" href="../img/CSRF-DemoPage.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/CSRF-DemoPage.png" /></a></p>
<p>Right-click and choose <strong>Inspect</strong> on the web page to reveal the hidden link.</p>
<p>You can <strong>log out</strong> and then <strong>log in</strong> again: your password has not been changed.</p>
<h3 id="attack-logs_4">Attack Logs</h3>
<p>The password change has been blocked by FortiWeb.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.072.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.072.png" /></a></p>
<details class="tip">
<summary>Reseting the database for the next Labs</summary>
<ul>
<li>Browse to <a href="https://@PREFIX.@REGION.cloudapp.azure.com/setup.php" target="_blank">https://@PREFIX.@REGION.cloudapp.azure.com/setup.php</a></li>
<li>Click on <strong>Create / Reset Database</strong></li>
<li>You can now login with the original password</li>
</ul>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.006.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.006.png" /></a></p>
</details>
</details>
<details class="note">
<summary>Hidden Fields Protection</summary>
<h2 id="hidden-fields-protection">Hidden Fields Protection</h2>
<p>Hidden form inputs are often written into an HTML page by the web server when it serves that page to the client and are not visible on the rendered web page. Because HTTP is essentially stateless, like cookies, hidden form inputs are one way that web applications can use to remember session data from one page request to the next (called “persistence”).</p>
<p>Since they are not rendered visible, hidden inputs are sometimes erroneously perceived as safe. But like session cookies, hidden form inputs store the software’s state information client-side, instead of server-side. This makes it vulnerable.</p>
<h3 id="configuration_5">Configuration</h3>
<p><code>Web Protection &gt; Input Validation &gt; Hidden Fields</code></p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.078.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.078.png" /></a></p>
<h3 id="testing-hidden-field-protection">Testing hidden field protection</h3>
<p>Download those small and large images to your computer:</p>
<ul>
<li><a href="/download/small.png" target="_blank">Small file</a> (14 Ko)</li>
<li><a href="/download/large.png" target="_blank">Large file</a> (433 Ko)</li>
</ul>
<p>Browse to <a href="https://@PREFIX.@REGION.cloudapp.azure.com/vulnerabilities/upload" target="_blank">https://@PREFIX.@REGION.cloudapp.azure.com/vulnerabilities/upload</a> and <strong>upload</strong> both images.</p>
<p>You may upload images smaller than 100 KB, but uploading images larger than 100 KB is not allowed.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.079.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.079.png" /></a></p>
<p>Uploading images larger than 100 KB is not allowed.</p>
<p>Right click the page, select <strong>Inspect</strong>, go to <strong>Inspector</strong> tab (Firefox) or <strong>Element</strong> tab (Chrome, Edge) and find the <strong>MAX_FILE_SIZE</strong> hidden form.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.080.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.080.png" /></a></p>
<p>Change the value to <strong>500,000</strong> and try to upload the large image again. <strong>The request is blocked</strong>.</p>
<h3 id="attack-logs_5">Attack Logs</h3>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.081.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.081.png" /></a></p>
</details>
<details class="note">
<summary>File Security</summary>
<h2 id="file-security">File Security</h2>
<p>You can configure FortiWeb to perform the following tasks:</p>
<ul>
<li>Restrict file uploads based upon file type and size</li>
<li>Scan uploaded files for viruses</li>
<li>Submit uploaded files to FortiSandbox or FortiNDR</li>
</ul>
<h3 id="configuration_6">Configuration</h3>
<p><code>Web Protection &gt; Input Validation &gt; File Security</code></p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.086.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.086.png" /></a></p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.087.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.087.png" /></a></p>
<h3 id="testing-file-security">Testing file security</h3>
<p>Download <a href="https://secure.eicar.org/eicar_com.zip" target="_blank">https://secure.eicar.org/eicar_com.zip</a> on your computer.</p>
<p>Browse to <a href="https://@PREFIX.@REGION.cloudapp.azure.com/vulnerabilities/upload/" target="_blank">https://@PREFIX.@REGION.cloudapp.azure.com/vulnerabilities/upload/</a> and upload <strong>eicar_com.zip</strong>.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.088.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.088.png" /></a></p>
<h3 id="attack-logs_6">Attack Logs</h3>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.089.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.089.png" /></a></p>
</details>
<details class="note">
<summary>Web Shell Detection</summary>
<h2 id="web-shell-detection">Web Shell Detection</h2>
<p>Attackers may attempt to upload Trojan horse code (written in scripting languages such as PHP and ASP) to the back-end web servers. The Trojan then infects clients who access an infected web page.</p>
<h3 id="configuration_7">Configuration</h3>
<p><code>Web Protection &gt; Input Validation &gt; Web Shell Detection</code></p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.090.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.090.png" /></a></p>
<h3 id="testing-web-shell-detection">Testing Web Shell detection</h3>
<p>First you need to <strong>disable Antivirus Scan</strong> as this may overlap Web Shell detection.</p>
<p>Browse to <code>Web Protection &gt; Input Validation &gt; File Security</code>, open <strong>DVWA_FILE_SECURITY_POLICY</strong> and disable Antivirus Scan.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.091.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.091.png" /></a></p>
<p>Download a Webshell on Github: <a href="https://raw.githubusercontent.com/tennc/webshell/master/php/wso/wso.php" target="_blank">https://raw.githubusercontent.com/tennc/webshell/master/php/wso/wso.php</a></p>
<p>Browse to <a href="https://@PREFIX.@REGION.cloudapp.azure.com/vulnerabilities/upload/" target="_blank">https://@PREFIX.@REGION.cloudapp.azure.com/vulnerabilities/upload/</a> and upload wso.php.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.092.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.092.png" /></a></p>
<h3 id="attack-logs_7">Attack Logs</h3>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.093.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.093.png" /></a></p>
</details>
<details class="note">
<summary>Let’s Encrypt Certificates</summary>
<h2 id="lets-encrypt-certificates">Let’s Encrypt Certificates</h2>
<p>Let's Encrypt certificates are free and valid for 90 days, during which renewal can take place at any time. This is handled by an automated process designed to overcome manual creation, validation, signing, installation, and renewal of certificates for secure websites.</p>
<h3 id="configuration_8">Configuration</h3>
<p><code>Server Objects &gt; Certificates &gt; Let's Encrypt</code></p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.140.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.140.png" /></a></p>
<h3 id="generating-a-new-lets-encrypt-certificate">Generating a new Let’s Encrypt certificate</h3>
<p>Until now we have connected to the application with the default certificate.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.141.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.141.png" /></a></p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.142.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.142.png" /></a></p>
<p>Let’s configure FortiWeb to automatically obtain (and renew) a certificate from Let's encrypt.</p>
<div class="admonition tip">
<p>For this lab, <strong>we need to temporarily shutdown FWB-B</strong>. It's crucial that the Primary member, FWB-A, which manages the configuration, is also the one handling the traffic. This is because the Let's Encrypt procedure relies on a challenge mechanism. If FWB-A sets up a challenge, but Let's Encrypt connects to FWB-B to verify it, the certificate generation will fail.</p>
<p>You can turn FWB-B back on after completing this lab.</p>
</div>
<p>Browse to <code>Server Objects &gt; Certificates &gt; Let's Encrypt</code> and check that the domain is correct.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.143.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.143.png" /></a></p>
<p>Browse to <code>Policy &gt; Server Policy</code>, open <strong>DVWA_POLICY</strong>, choose <strong>Let's Encrypt</strong> option and select <strong>DVWA_LE_CERTIFICATE</strong>.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.144.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.144.png" /></a></p>
<p>Go back to <code>Server Objects &gt; Certificates &gt; Let's Encrypt</code> and click on <strong>Issue</strong> (1).</p>
<p>Be patient and avoid clicking on <strong>Issue</strong> multiple times. Refresh the page to check for status updates. You can also view the <strong>Event Logs</strong> to monitor the progress of the process.</p>
<p>After an average of 30 seconds, the <strong>Status</strong> (2) should be green.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.145.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.145.png" /></a></p>
<p>Close and open your browser.</p>
<p>Browse to <a href="https://@PREFIX.@REGION.cloudapp.azure.com" target="_blank">https://@PREFIX.@REGION.cloudapp.azure.com</a>.</p>
<p>Now you should have a valid certificate.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.146.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.146.png" /></a></p>
<h3 id="event-logs">Event Logs</h3>
<p>Check the Event Logs.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.147.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.147.png" /></a></p>
</details>
<details class="note">
<summary>Allow Method</summary>
<h2 id="allow-method">Allow Method</h2>
<p>You can configure policies that allow only specific HTTP request methods. This can be useful for preventing attacks, such as those exploiting the HTTP method TRACE.</p>
<p>Many web applications only require GET and POST. Disabling all unused methods reduces the potential attack surface area for attackers.</p>
<h3 id="configuration_9">Configuration</h3>
<p><code>Web Protection &gt; Access &gt; Allow Method</code></p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.097.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.097.png" /></a></p>
<h3 id="testing-allow-method">Testing Allow Method</h3>
<p><span style="color:red;">This lab is only compatible with <strong>Firefox</strong>.</span></p>
<ul>
<li>
<p>Open <strong>Firefox</strong> and Browse to <a href="https://@PREFIX.@REGION.cloudapp.azure.com" target="_blank">https://@PREFIX.@REGION.cloudapp.azure.com</a></p>
</li>
<li>
<p>Right-click anywhere on the page and select "<strong>Inspect</strong>" or press F12</p>
</li>
<li>
<p>Click on the <strong>Network</strong> tab (1).</p>
</li>
<li>
<p><strong>Reload</strong> the page by pressing F5 or clicking the <strong>reload icon</strong> (2) in the toolbar.</p>
</li>
<li>
<p>Choose any request, right-click on it, and select <strong>Edit and Resend</strong> (3).</p>
</li>
<li>
<p>In the new panel on the left, there is a dropdown menu for selecting the <strong>HTTP method</strong> (4). Click the dropdown arrow and select <strong>HEAD</strong> as the HTTP method you want to use for this request.</p>
</li>
<li>
<p>Click the <strong>Send</strong> button (5) to resend the request with the modified HTTP method.</p>
</li>
</ul>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.098.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.098.png" /></a></p>
<h3 id="attack-logs_8">Attack logs</h3>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.100.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.100.png" /></a></p>
</details>
<details class="note">
<summary>Bot Mitigation Policy</summary>
<h2 id="bot-mitigation-policy">Bot Mitigation Policy</h2>
<p>To quickly protect websites, mobile apps and APIs from automated threats, you can configure the bot mitigation feature to check more specific signatures such as client events, and occurrence of suspicious behaviors, etc. of regular clients.</p>
<h3 id="configuration_10">Configuration</h3>
<p><code>Bot Mitigation &gt; Bot Mitigation Policy</code></p>
<p>Bot Mitigation Policy protects from automated threats with different methods:</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.101.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.101.png" /></a></p>
<table>
<thead>
<tr>
<th>Detection Method</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Bot Deception</strong></td>
<td>Inserts invisible links in HTML responses to distinguish between regular clients and malicious bots like web crawlers.</td>
</tr>
<tr>
<td><strong>Biometrics-based Detection</strong></td>
<td>Uses client events like mouse movement and keyboard activity to determine whether a request is coming from a human or a bot.</td>
</tr>
<tr>
<td><strong>Threshold-based Detection</strong></td>
<td>Sets rules based on occurrence, time period, and severity of suspicious behavior to assess whether a request is human or bot-generated.</td>
</tr>
<tr>
<td><strong>Known Bots</strong></td>
<td>Protects against malicious bots like DoS and spam, while allowing known good bots like search engines.</td>
</tr>
</tbody>
</table>
<h3 id="testing-bot-deception">Testing Bot Deception</h3>
<p>Browse to <a href="https://@PREFIX.@REGION.cloudapp.azure.com/login.php" target="_blank">https://@PREFIX.@REGION.cloudapp.azure.com/login.php</a>, right click and select “View Page Source”.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.102.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.102.png" /></a></p>
<p>There’s a hidden link. Malicious bots like web crawler may request the link…</p>
<p>Click on it or Browse to <a href="https://@PREFIX.@REGION.cloudapp.azure.com/fake_url.php" target="_blank">https://@PREFIX.@REGION.cloudapp.azure.com/fake_url.php</a>.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.103.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.103.png" /></a></p>
<h3 id="attack-logs_9">Attack Logs</h3>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.104.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.104.png" /></a></p>
</details>
<details class="note">
<summary>DoS Protection Policy</summary>
<h2 id="dos-protection-policy">DoS Protection Policy</h2>
<p>You can protect your web assets from a wide variety of denial of service (DoS) attacks.</p>
<p>DoS features are organized by which open system interconnections (OSI) model layer they use primarily to apply the rate limit:</p>
<ul>
<li>Application layer (HTTP or HTTPS)</li>
<li>Network and transport layer (TCP/IP)</li>
</ul>
<h3 id="configuration_11">Configuration</h3>
<p><code>DoS Protection &gt; DoS Protection Policy</code></p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.105.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.105.png" /></a></p>
<h3 id="testing-dos-http-flood">Testing DoS HTTP Flood</h3>
<p>For this test, HTTP request limit / sec is set very low (5 instead of default 500).</p>
<p>Go to any page and refresh very quickly with F5. Alternatively, hold down SHIFT button and click the Reload button several times.</p>
<p>Go to Attack Logs.</p>
<h3 id="attack-logs_10">Attack Logs</h3>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.106.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.106.png" /></a></p>
</details>
<details class="note">
<summary>URL Rewriting</summary>
<h2 id="url-rewriting">URL Rewriting</h2>
<p>URL rewriting can prevent the disclosure of underlying technology or website structures to HTTP clients.</p>
<p>Aside from security reasons, rewriting and redirects can be for aesthetic or business purposes, too.</p>
<h3 id="configuration_12">Configuration</h3>
<p><code>Application Delivery &gt; URL Rewriting</code></p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.107.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.107.png" /></a></p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.108.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.108.png" /></a></p>
<h3 id="testing-url-rewrite-301-redirect">Testing URL Rewrite (301 Redirect)</h3>
<p>Browse to <a href="https://@PREFIX.@REGION.cloudapp.azure.com/fortinet" target="_blank">https://@PREFIX.@REGION.cloudapp.azure.com/fortinet</a></p>
<p>You will be redirected to <strong>www.fortinet.com</strong>.</p>
<h3 id="testing-url-rewrite-rewrite-http-header">Testing URL Rewrite (Rewrite HTTP Header)</h3>
<p>Browse to <a href="https://@PREFIX.@REGION.cloudapp.azure.com" target="_blank">https://@PREFIX.@REGION.cloudapp.azure.com</a> and authenticate.</p>
<p>Browse to <a href="https://@PREFIX.@REGION.cloudapp.azure.com/change" target="_blank">https://@PREFIX.@REGION.cloudapp.azure.com/change</a>.</p>
<p>You will be redirected to /vulnerabilities/csrf/ page.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.109.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.109.png" /></a></p>
<h3 id="traffic-logs">Traffic logs</h3>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.110.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.110.png" /></a></p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.111.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.111.png" /></a></p>
</details>
<details class="note">
<summary>User Tracking</summary>
<h2 id="user-tracking">User Tracking</h2>
<p>The user tracking feature allows you to track sessions by user and capture a username for reference in traffic and attack log messages.</p>
<h3 id="configuration_13">Configuration</h3>
<p><code>Tracking &gt; User Tracking</code></p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.128.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.128.png" /></a></p>
<h3 id="testing-user-tracking">Testing User Tracking</h3>
<p>Login to DVWA with any username...</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Username</th>
<th style="text-align: left;">Password</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">admin</td>
<td style="text-align: left;">password</td>
</tr>
<tr>
<td style="text-align: left;">gordonb</td>
<td style="text-align: left;">abc123</td>
</tr>
<tr>
<td style="text-align: left;">1337</td>
<td style="text-align: left;">charley</td>
</tr>
<tr>
<td style="text-align: left;">pablo</td>
<td style="text-align: left;">letmein</td>
</tr>
<tr>
<td style="text-align: left;">smithy</td>
<td style="text-align: left;">password</td>
</tr>
</tbody>
</table>
<p>...and perform any attack in the list:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">URL</th>
<th>Attack pattern</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><a href="https://@PREFIX.@REGION.cloudapp.azure.com/vulnerabilities/exec/" target="_blank">/vulnerabilities/exec/</a></td>
<td><strong><code>;ls</code></strong></td>
</tr>
<tr>
<td style="text-align: left;"><a href="https://@PREFIX.@REGION.cloudapp.azure.com/vulnerabilities/sqli/" target="_blank">/vulnerabilities/sqli/</a></td>
<td><strong><code>‘OR 1=1#</code></strong></td>
</tr>
<tr>
<td style="text-align: left;"><a href="/csrf-demo-page.html" target="_blank">CSRF</a></td>
<td>The page will exploit CSRF attack</td>
</tr>
<tr>
<td style="text-align: left;"><a href="https://@PREFIX.@REGION.cloudapp.azure.com/vulnerabilities/upload/" target="_blank">/vulnerabilities/upload/</a></td>
<td>Change the hidden field <strong>MAX_FILE_SIZE</strong> and reload the page (F5)</td>
</tr>
<tr>
<td style="text-align: left;"><a href="https://@PREFIX.@REGION.cloudapp.azure.com/security.php" target="_blank">/security.php</a></td>
<td>Change security cookie value to <strong>medium</strong> and reload the page (F5)</td>
</tr>
<tr>
<td style="text-align: left;"><a href="https://@PREFIX.@REGION.cloudapp.azure.com/vulnerabilities/upload/" target="_blank">/vulnerabilities/upload/</a></td>
<td>Upload <strong>eicar.zip</strong></td>
</tr>
</tbody>
</table>
<h3 id="attack-logs_11">Attack Logs</h3>
<p>Browse to <strong>Attack Logs</strong> and right click a column heading to select the columns to display. Choose <strong>Username</strong> and <strong>Apply</strong>.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.129.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.129.png" /></a></p>
<p>The <strong>Username</strong> will be the last column, but you can move it to the left.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.130.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.130.png" /></a></p>
</details>
<p><span style="color:red;">The remaining labs are optional and can be explored if you have extra time.</span></p>
<details class="example">
<summary>Custom Policy</summary>
<h2 id="custom-policy">Custom Policy</h2>
<p>Custom rules provide a degree of flexibility for complex conditions. You can combine any or all of these criteria:</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.060.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.060.png" /></a></p>
<h3 id="configuration_14">Configuration</h3>
<p>Example #1 – Detecting Vulnerability Scanning</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.061.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.061.png" /></a></p>
<p>Example #2 – Detecting Brute Force Login</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.062.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.062.png" /></a></p>
<h3 id="testing-vulnerability-scanning">Testing Vulnerability Scanning</h3>
<p>Browse to <a href="https://@PREFIX.@REGION.cloudapp.azure.com/vulnerabilities/sqli/" target="_blank">https://@PREFIX.@REGION.cloudapp.azure.com/vulnerabilities/sqli/</a> and submit <code>‘or 1=1#</code> 11 times.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.063.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.063.png" /></a></p>
<p>FortiWeb blocks SQL injection for the first 10 requests and quarantine the IP at the 11<sup>th</sup> request.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.064.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.064.png" /></a></p>
<p>Check the blocked IPs and release it for the next test.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.065.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.065.png" /></a></p>
<h3 id="testing-brute-force-attack">Testing brute force attack</h3>
<p>Try to login 20 times very quickly with user “p” and no password. You can also reduce the configuration to 3 occurrences for testing purpose. <strong>Don’t forget to configure it back to 20 after your test.</strong></p>
<p>After few requests, FortiWeb enforces a CAPTCHA to check if this is a bot or not. You can put a wrong answer to simulate a bot activity.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.066.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.066.png" /></a></p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.067.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.067.png" /></a></p>
<p>Check the blocked IPs and release it for the next test.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.065.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.065.png" /></a></p>
<h3 id="attack-logs_12">Attack Logs</h3>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.068.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.068.png" /></a></p>
</details>
<details class="example">
<summary>HTTP Protocol Constraints</summary>
<h2 id="http-protocol-constraints">HTTP Protocol Constraints</h2>
<p>Protocol constraints govern features such as the HTTP header fields in the protocol itself, as well as the length of the HTML, XML, or other documents or encapsulated protocols carried in the HTTP body payload.</p>
<p>Use protocol constraints to prevent attacks such as buffer overflows. Buffer overflows can occur in web servers and applications that do not restrict elements of the HTTP protocol to acceptable lengths, or that mishandle malformed requests. Such errors can lead to security vulnerabilities.</p>
<h3 id="configuration_15">Configuration</h3>
<p><code>Web Protection &gt; Protocol &gt; HTTP</code></p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.047.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.047.png" /></a></p>
<h3 id="performing-duplicate-name-attack">Performing duplicate name attack</h3>
<p>Browse to <a href="https://@PREFIX.@REGION.cloudapp.azure.com/vulnerabilities/brute/?username=admin&username=admin&password=password&Login=Login#" target="_blank">https://@PREFIX.@REGION.cloudapp.azure.com/vulnerabilities/brute/?username=admin&amp;username=admin&amp;password=password&amp;Login=Login#</a></p>
<h3 id="attack-logs_13">Attack Logs</h3>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.048.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.048.png" /></a></p>
</details>
<details class="example">
<summary>HTTP Header Security</summary>
<h2 id="http-header-security">HTTP Header Security</h2>
<p>HTTP response security headers are a set of standard HTTP response headers proposed to prevent or mitigate known XSS, clickjacking, and MIME sniffing security vulnerabilities. These response headers define security policies to client browsers so that the browsers avoid exposure to known vulnerabilities when handling requests.</p>
<p>When FortiWeb's HTTP Security Headers feature is enabled, headers with specified values are inserted into HTTP responses coming from the backend web servers. This is a quick and simple solution to address the security vulnerabilities on your website without code and configuration changes. The following includes the security headers that FortiWeb can insert into responses:</p>
<div class="language-py highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="n">X</span><span class="o">-</span><span class="n">Frame</span><span class="o">-</span><span class="n">Options</span><span class="p">:</span> <span class="n">DENY</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="n">X</span><span class="o">-</span><span class="n">Frame</span><span class="o">-</span><span class="n">Options</span><span class="p">:</span> <span class="n">SAMEORIGIN</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="n">X</span><span class="o">-</span><span class="n">Frame</span><span class="o">-</span><span class="n">Options</span><span class="p">:</span> <span class="n">ALLOW</span><span class="o">-</span><span class="n">FROM</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="n">X</span><span class="o">-</span><span class="n">Content</span><span class="o">-</span><span class="n">Type</span><span class="o">-</span><span class="n">Options</span><span class="p">:</span> <span class="n">nosniff</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="n">X</span><span class="o">-</span><span class="n">XSS</span><span class="o">-</span><span class="n">Protection</span><span class="p">:</span> <span class="mi">1</span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="n">X</span><span class="o">-</span><span class="n">XSS</span><span class="o">-</span><span class="n">Protection</span><span class="p">:</span> <span class="mi">1</span><span class="p">;</span> <span class="n">mode</span><span class="o">=</span><span class="n">block</span>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="n">Content</span><span class="o">-</span><span class="n">Security</span><span class="o">-</span><span class="n">Policy</span><span class="p">:</span> <span class="n">default</span><span class="o">-</span><span class="n">src</span> <span class="s1">&#39;self&#39;</span>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="n">Feature</span><span class="o">-</span><span class="n">Policy</span><span class="p">:</span> <span class="n">microphone</span> <span class="s1">&#39;none&#39;</span><span class="p">;</span> <span class="n">geolocation</span> <span class="s1">&#39;none&#39;</span>
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a><span class="n">Referrer</span><span class="o">-</span><span class="n">Policy</span><span class="p">:</span> <span class="n">no</span><span class="o">-</span><span class="n">referrer</span>
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a><span class="n">Referrer</span><span class="o">-</span><span class="n">Policy</span><span class="p">:</span> <span class="n">no</span><span class="o">-</span><span class="n">referrer</span><span class="o">-</span><span class="n">when</span><span class="o">-</span><span class="n">downgrade</span>
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a><span class="n">Referrer</span><span class="o">-</span><span class="n">Policy</span><span class="p">:</span> <span class="n">same</span><span class="o">-</span><span class="n">origin</span>
</span><span id="__span-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a><span class="n">Referrer</span><span class="o">-</span><span class="n">Policy</span><span class="p">:</span> <span class="n">origin</span>
</span><span id="__span-7-13"><a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a><span class="n">Referrer</span><span class="o">-</span><span class="n">Policy</span><span class="p">:</span> <span class="n">strict</span><span class="o">-</span><span class="n">origin</span>
</span><span id="__span-7-14"><a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a><span class="n">Referrer</span><span class="o">-</span><span class="n">Policy</span><span class="p">:</span> <span class="n">origin</span><span class="o">-</span><span class="n">when</span><span class="o">-</span><span class="n">cross</span><span class="o">-</span><span class="n">origin</span>
</span><span id="__span-7-15"><a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a><span class="n">Referrer</span><span class="o">-</span><span class="n">Policy</span><span class="p">:</span> <span class="n">strict</span><span class="o">-</span><span class="n">origin</span><span class="o">-</span><span class="n">when</span><span class="o">-</span><span class="n">cross</span><span class="o">-</span><span class="n">origin</span>
</span><span id="__span-7-16"><a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a><span class="n">Referrer</span><span class="o">-</span><span class="n">Policy</span><span class="p">:</span> <span class="n">unsafe</span><span class="o">-</span><span class="n">url</span>
</span></code></pre></div>
<h3 id="configuration_16">Configuration</h3>
<p>Web Protection &gt; Advanced Protection &gt; HTTP Header Security</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.073.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.073.png" /></a></p>
<h3 id="testing-http-header-security">Testing HTTP Header Security</h3>
<p>Right click on the Web page, select <strong>Inspect</strong>, select <strong>Network</strong> tab, browse to <a href="https://@PREFIX.@REGION.cloudapp.azure.com" target="_blank">https://@PREFIX.@REGION.cloudapp.azure.com</a>, <strong>reload</strong> the page, select the first <strong>entry</strong>, search for <strong>Response Header</strong> and find the 3 <strong>X-Headers</strong>.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.074.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.074.png" /></a></p>
</details>
<details class="example">
<summary>Parameter Validation</summary>
<h2 id="parameter-validation">Parameter Validation</h2>
<p>You can configure rules to validate parameters (input) of your web applications.</p>
<p>For example, one web page might have an HTML form with multiple inputs, including:</p>
<ul>
<li>A username</li>
<li>A password</li>
<li>A preference for whether or not to remember the login</li>
</ul>
<p>Within the input rule for that web page, you can define separate rules for each parameter in the request: one rule for the <strong>username</strong> parameter, one rule for the <strong>password</strong> parameter, and one rule for the <strong>preference</strong> parameter. You can use the password rule to enforce password complexity by requiring it to match a <strong>Level 2 Password</strong> data type.</p>
<h3 id="configuration_17">Configuration</h3>
<p><code>Web Protection &gt; Input Validation &gt; Parameter Validation</code></p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.075.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.075.png" /></a></p>
<h3 id="testing-parameter-validation">Testing parameter validation</h3>
<p>Browse to <a href="https://@PREFIX.@REGION.cloudapp.azure.com/vulnerabilities/exec/" target="_blank">https://@PREFIX.@REGION.cloudapp.azure.com/vulnerabilities/exec/</a>. In the <strong><code>Enter an IP address</code></strong> form enter a random string that is not an IP.</p>
<p>You’re not blocked because the rule action is <strong>Alert</strong>.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.076.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.076.png" /></a></p>
<h3 id="attack-logs_14">Attack Logs</h3>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.077.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.077.png" /></a></p>
</details>
<details class="example">
<summary>Man in the Browser (MiTB) Protection</summary>
<h2 id="man-in-the-browser-mitb-protection">Man in the Browser (MiTB) Protection</h2>
<p>The Man-in-the-Browser (MiTB) attack uses Trojan Horse to intercept and manipulate calls between the browser and its security mechanisms or libraries on-the-fly. The Trojan Horse sniffs or modifies transactions as they are formed on the browser, but still displays back the user's intended transaction. The most common objective of this attack is to cause financial fraud by manipulating transactions of Internet Banking systems, even when other authentication factors are in use.</p>
<p>To protect the user inputs from being attacked by MiTB, FortiWeb implements security rules including obfuscation, encryption, anti-keylogger, and Ajax request allow list.</p>
<h3 id="configuration_18">Configuration</h3>
<p><code>Web Protection &gt; Advanced Protection &gt; Man in the Browser Protection</code></p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.082.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.082.png" /></a></p>
<h3 id="testing-mitb">Testing MitB</h3>
<p>Browse to <a href="https://@PREFIX.@REGION.cloudapp.azure.com/vulnerabilities/brute/" target="_blank">https://@PREFIX.@REGION.cloudapp.azure.com/vulnerabilities/brute/</a></p>
<p>Right click the page, select <strong>Inspect</strong>, go to <strong>Inspector</strong> tab (Firefox) or <strong>Element</strong> tab (Chrome, Edge) and find the username / password form.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.083.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.083.png" /></a></p>
<p>Now go to the web protection profile configuration.</p>
<p><code>Policy &gt; Web Protection Profile &gt; DVWA_PROTECTION_PROFILE</code></p>
<p>The “Man in the Browser Protection” setting should be empty. Select DVWA_PROTECTION_PROFILE and click OK.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.084.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.084.png" /></a></p>
<p>Refresh your browser. The form is now protected with MitB.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.085.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.085.png" /></a></p>
</details>
<details class="example">
<summary>URL Access</summary>
<h2 id="url-access">URL Access</h2>
<p>URL access rules define which HTTP requests FortiWeb accepts or denies based on:</p>
<ul>
<li>Host name</li>
<li>URL</li>
<li>Origin of the request.</li>
</ul>
<h3 id="configuration_19">Configuration</h3>
<p>Web Protection &gt; Access &gt; URL Access</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.094.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.094.png" /></a></p>
<h3 id="testing-url-access">Testing URL Access</h3>
<p>Browse to <a href="https://@PREFIX.@REGION.cloudapp.azure.com/vulnerabilities/about.php">https://@PREFIX.@REGION.cloudapp.azure.com/about.php</a></p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.095.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.095.png" /></a></p>
<h3 id="attack-logs_15">Attack Logs</h3>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.096.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.096.png" /></a></p>
</details>
<details class="example">
<summary>HTTP Authentication</summary>
<h2 id="http-authentication">HTTP Authentication</h2>
<p>FortiWeb can authenticate browsers before they are permitted to access a web page.</p>
<h3 id="configuration_20">Configuration</h3>
<p><code>User &gt; Local User</code></p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.112.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.112.png" /></a></p>
<p><code>User &gt; User Group &gt; User Group</code></p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.113.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.113.png" /></a></p>
<p><code>Application Delivery &gt; Authentication</code></p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.114.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.114.png" /></a></p>
<h3 id="testing-authentication">Testing authentication</h3>
<p>Browse to <a href="https://@PREFIX.@REGION.cloudapp.azure.com/instructions.php" target="_blank">https://@PREFIX.@REGION.cloudapp.azure.com/instructions.php</a>.</p>
<p>Authenticate with username <code>demo</code>, password <code>demo</code>.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.115.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.115.png" /></a></p>
</details>
<details class="example">
<summary>IP List</summary>
<h2 id="ip-list">IP List</h2>
<p>You can define which source IP addresses are trusted clients, undetermined, or distrusted.</p>
<h3 id="configuration_21">Configuration</h3>
<p><code>IP Protection &gt; IP List</code></p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.116.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.116.png" /></a></p>
<h3 id="testing-ip-list">Testing IP List</h3>
<p>Browse to <a href="https://@PREFIX.@REGION.cloudapp.azure.com/phpinfo.php" target="_blank">https://@PREFIX.@REGION.cloudapp.azure.com/phpinfo.php</a>.</p>
<p>Copy your <strong>public IP</strong> located in <code>HTTP Headers Information &gt; X-Forwarded-For</code></p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.117.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.117.png" /></a></p>
<p>On FortiWeb, Browse to <code>IP Protection &gt; IP List</code> and add your public IP in the Block IP List.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.118.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.118.png" /></a></p>
<p>Refresh your page on DVWA. You should be blocked.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.119.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.119.png" /></a></p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><center><strong>Remove your IP from the list!</strong></center></p>
</div>
<h3 id="attack-logs_16">Attack Logs</h3>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.120.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.120.png" /></a></p>
</details>
<details class="example">
<summary>FortiGate Quarantined IPs</summary>
<h2 id="fortigate-quarantined-ips">FortiGate Quarantined IPs</h2>
<p>FortiGate can maintain a list of source IPs that it prevents from interacting with the network and protected systems. You can configure FortiWeb to receive this list of IP addresses at intervals you specify. You can then configure an inline protection profile to detect the IP addresses in the list and take an appropriate action.</p>
<h3 id="configuration_22">Configuration</h3>
<p><code>System &gt; Config &gt; FortiGate Integration</code></p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.121.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.121.png" /></a></p>
<h3 id="testing-fortigate-integration">Testing FortiGate integration</h3>
<p>On FortiWeb browse to <code>System &gt; Config &gt; FortiGate Integration</code> and change the admin credentials with yours.</p>
<p>On FortiGate browse to <code>Dashboard &gt; Quarantine Monitor</code> and manually add a <strong>Ban IP</strong>.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.122.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.122.png" /></a></p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.123.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.123.png" /></a></p>
<p>On FortiWeb browse to <code>Dashboard &gt; Blocked IPs</code>. You should see the new IP received from FortiGate.</p>
</details>
<details class="example">
<summary>GEO IP</summary>
<h2 id="geo-ip">GEO IP</h2>
<p>While numerous websites have a global reach, some are region-specific. For instance, government web applications often cater exclusively to their own residents.</p>
<h3 id="configuration_23">Configuration</h3>
<p><code>IP Protection &gt; Geo IP</code></p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.124.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.124.png" /></a></p>
<h3 id="testing-geo-ip">Testing Geo IP</h3>
<p>browse to <code>IP Protection &gt; Geo IP</code> and add Canada as new Country to block.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.125.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.125.png" /></a></p>
<p>Now try to go on DVWA; you should be blocked.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.126.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.126.png" /></a></p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><center><strong>Remove Canada from the list!</strong></center></p>
</div>
<h3 id="attack-logs_17">Attack Logs</h3>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.127.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.127.png" /></a></p>
</details>
<details class="example">
<summary>Vulnerability Scanner</summary>
<h2 id="vulnerability-scanner">Vulnerability Scanner</h2>
<p>You can scan your web servers for known vulnerabilities, which helps you design protection profiles.</p>
<h3 id="configuration_24">Configuration</h3>
<p>Web Vulnerability Scan &gt; Scan Profile</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.131.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.131.png" /></a></p>
<h3 id="performing-a-scan">Performing a scan</h3>
<p>Open a browser to DVWA, authenticate and copy the PHPSESSID cookie value.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.132.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.132.png" /></a></p>
<p>On FortiWeb browse to <code>Web Vulnerability Scan &gt; Scan Profile</code> and configure the Customer Headers as follow with your <code>PHPSESSID</code> value.</p>
<div class="language-py highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="n">Cookie</span><span class="p">:</span> <span class="n">security</span><span class="o">=</span><span class="n">low</span><span class="p">;</span> <span class="n">PHPSESSID</span><span class="o">=</span><span class="n">evgihu3t04ht0tj5agcin4vec1</span>
</span></code></pre></div>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.133.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.133.png" /></a></p>
<p>Click OK.</p>
<p>browse to <code>Web Vulnerability Scan &gt; Web Vulnerability Scan Policy</code> and run the scan.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.134.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.134.png" /></a></p>
<p>Check the logs.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.135.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.135.png" /></a></p>
<p>browse to <code>Scan History</code>, select a line and click on Download.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.136.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.136.png" /></a></p>
<p>Download the XML report.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.137.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.137.png" /></a></p>
<p>browse to <code>Scanner Integration</code> and import the XML report.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.138.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.138.png" /></a></p>
<p>You can choose to mitigate a found vulnerability.</p>
<p><a class="glightbox" href="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.139.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="" src="../img/Aspose.Words.fc7ec648-3633-4466-b24a-e7a2902fc6a3.139.png" /></a></p>
</details>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../hol-nsg-fgt-lab-1/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Lab 1 - Azure NSG &amp; FortiGate">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Lab 1 - Azure NSG & FortiGate
              </div>
            </div>
          </a>
        
        
          
          <a href="../architecture/" class="md-footer__link md-footer__link--next" aria-label="Next: Reference Architecture">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Reference Architecture
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Try and be nice
    </div>
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.instant", "navigation.tracking", "navigation.top", "navigation.footer", "search.suggest", "search.highlight", "content.code.copy", "content.code.annotate", "content.tabs.link"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.af256bd8.min.js"></script>
      
        <script src="../javascripts/extra.js"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>